<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.web.vop.persistence.BasketMapper">

   <resultMap type="com.web.vop.domain.BasketVO"
      id="basketResultMap">
      
      <result property="memberId" column="MEMBER_ID" /> 
      <result property="productId" column="PRODUCT_ID" />
      <result property="productNum" column="PRODUCT_NUM"/>
   </resultMap>
   
   <!-- 내 장바구니 물품 목록 조회 -->
   <select id="selectByMemberId" resultMap="basketResultMap">
   		SELECT * FROM (
    		SELECT * FROM (
   				SELECT BASKET.*, ROW_NUMBER() OVER (ORDER BY PRODUCT_ID DESC) RN FROM BASKET
        		WHERE MEMBER_ID = #{memberId}
    		)  WHERE RN BETWEEN #{start} AND #{end}
		) BR JOIN PRODUCT ON BR.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_STATE = '판매중'
   </select>
   
   
</mapper>